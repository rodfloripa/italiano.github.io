<!DOCTYPE html>
<html>
<head>
  <title>Reggenza verbale</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="Este site pode ser utilizado para verificar se conhecemos a regencia de alguns verbos em italiano">
  <meta name="keywords" content=italiano,regencia verbal,italiano para brasileiros">
  <style>
    #progress-bar {
      width: 200px;
      height: 20px;
      background-color: #ccc;
      border-radius: 10px;
    }
     #help-button {
      width: calc(100px / 2);
      font-size: 18px;
      padding: 10px 0;
      border: 1px solid #ccc;
      border-radius: 5px;
      cursor: pointer;
      font-weight: bold;
    }
    
    #progress-bar-fill {
      height: 20px;
      background-color: #4CAF50;
      border-radius: 10px;
    }

    #file-input-label {
      font-size: 18px;
      padding: 10px 20px;
      border: 1px solid #ccc;
      border-radius: 5px;
      cursor: pointer;
    }

    #group-list {
      font-size: 18px;
      padding: 10px 20px;
    }

    #prev-card, #next-card {
      font-size: 24px;
      padding: 15px 30px;
      width: auto;
      height: auto;
    }

    #card {
      width: 40%;
      margin: 40px auto;
      font-size: 72px;
    }


    @media only screen and (max-width: 768px) {
      #card {
        width: 90%;
        margin: 20px auto;
        font-size: 36px;
      }

      #prev-card, #next-card {
        font-size: 18px;
        padding: 10px 20px;
      }
    }
  </style>
</head>
<body>
  <h1>Vocabolario</h1>
   <button id="help-button" onclick="exibirMensagem()">?</button>
  <label for="file-input" id="file-input-label">Caricare</label>
  <input type="file" id="file-input" style="display: none;" accept=".txt">
  <div id="progress-bar">
    <div id="progress-bar-fill" style="width: 0%;"></div>
  </div>
  <p id="progress-text">0.00%</p>
  <select id="group-list"></select>
  <div style="display: block; text-align: left;">
  <button id="prev-card" style="margin-right: 10px;">precedente</button>
  <button id="next-card">successivo</button>
  <div id="card"></div>
  </div>
  
   
  </div>

  
  <script>
                                 
    let flashcards = {};
    let currentGroup = null;
    let currentCardIndex = 0;
    let lezione = null;

    function loadFlashcards(file) {
      let reader = new FileReader();
      reader.onload = function(event) {
        let txt = event.target.result;
        let lines = txt.split("\n");
        let vocabolario = lines[0].trim();
        lezione = lines[1].trim();
        document.title = vocabolario;
        document.querySelector("h1").innerText = vocabolario;
        txt = txt.replace(/Vocabolario/g, vocabolario);
        txt = txt.replace(/Lezione/g, lezione);
        let group = null;
        let groupName = null;
        lines = txt.split("\n");
        flashcards = {};
        let newFlashcards = {};
        lines.forEach(line => {
          if (line.match(/^(Lezione|Grupo)/)) {
            group = line.trim();
            let groupNumber = line.trim().replace("Grupo", "").replace("Lezione", "");
            groupName = lezione + groupNumber;
            flashcards[group] = [];
            newFlashcards[groupName] = [];
          } else if (group && line.trim() !== "") {
            let sides = line.split("-");
            if (sides.length === 2) {
              flashcards[group].push({
                pergunta: sides[0].trim(),
                resposta: sides[1].trim()
              });
              newFlashcards[groupName].push({
                pergunta: sides[0].trim(),
                resposta: sides[1].trim()
              });
            }
          }
        });
        flashcards = newFlashcards;
        showGroups();
      };
      reader.readAsText(file);
    }

    function showGroups() {
      let groupList = document.getElementById("group-list");
      groupList.innerHTML = "";
      Object.keys(flashcards).forEach(group => {
        let option = document.createElement("option");
        option.value = group;
        option.text = group;
        groupList.appendChild(option);
      });
      document.getElementById("group-list").onchange = showFlashcards;
      groupList.value = Object.keys(flashcard)[1];
      showFlashcards();
    }

    function showFlashcards() {
      currentGroup = document.getElementById("group-list").value;
      currentCardIndex = 0;
      showCard();
    }

    function showCard() {
      let card = flashcards[currentGroup][currentCardIndex];
      let progresso = ((currentCardIndex + 1) / flashcards[currentGroup].length) * 100;
      document.getElementById("progress-bar-fill").style.width = `${progresso}%`;
      document.getElementById("progress-text").innerText = `${progresso.toFixed(2)}%`;
      document.getElementById("card").innerHTML = `
        <div style="background-color: yellow; padding: 10px; text-align: center; font-size: 52px; line-height: 1; width: 100%; margin: 0 auto;">
          <p>${card.pergunta}</p>
          <button onclick="showAnswer()" style="font-size: 36px;">Risposta</button>
          <div id="answer" style="max-height: 0; overflow: hidden; transition: max-height 0.5s ease-out; font-size: 52px;">${card.resposta}</div>
        </div>
      `;
    }

    function showAnswer() {
      let answer = document.getElementById("answer");
      if (answer.style.maxHeight === "0px" || answer.style.maxHeight === "") {
        answer.style.maxHeight = "500px";
        answer.style.transition = "max-height 0.5s ease-in";
      } else {
        answer.style.maxHeight = "0px";
        answer.style.transition = "max-height 0.5s ease-out";
      }
    }

    function nextCard() {
      currentCardIndex++;
      if (currentCardIndex >= flashcards[currentGroup].length) {
        let groups = Object.keys(flashcards);
        let currentIndex = groups.indexOf(currentGroup);
        if (currentIndex === groups.length - 1) {
          currentIndex = 0;
        } else {
          currentIndex++;
        }
        currentGroup = groups[currentIndex];
        currentCardIndex = 0;
        document.getElementById("group-list").value = currentGroup;
      }
      showCard();
    }

    function prevCard() {
      currentCardIndex--;
      if (currentCardIndex < 0) {
        let groups = Object.keys(flashcards);
        let currentIndex = groups.indexOf(currentGroup);
        if (currentIndex === 0) {
          currentIndex = groups.length - 1;
        } else {
          currentIndex--;
        }
        currentGroup = groups[currentIndex];
        currentCardIndex = flashcards[currentGroup].length - 1;
        document.getElementById("group-list").value = currentGroup;
      }
      showCard();
    }

    document.getElementById("file-input").addEventListener("change", function(event) {
      loadFlashcards(event.target.files[0]);
    });

    document.getElementById("next-card").onclick = nextCard;
    document.getElementById("prev-card").onclick = prevCard;

   window.onload = function() {
      fetch('Reggenza.txt')
        .then(response => response.text())
        .then(text => {
          let file = new File([text], 'Arq2.txt', {
            type: 'text/plain'
          });
          loadFlashcards(file);
        })
        .catch(error => console.error('Erro ao carregar arquivo:', error));
    }
     
    function exibirMensagem() {
      alert("Para criar sua própria lista de vocabulário, crie um arquivo .txt assim:\nTítulo do vocabulário\nLezione\nGrupo 1\nPalavra port - Palavra it\n.\n.\n.");
    }
     
  </script>
</body>
</html>
